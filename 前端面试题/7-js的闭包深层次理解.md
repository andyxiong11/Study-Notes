# js的作用域

## 作用域说明：一般理解指一个变量的作用范围
**es6之后有块级作用域**
1. 全局作用域
(1)全局作用域在页面打开时被创建，页面关闭时被销毁
(2)编写在script标签中的变量和函数，作用域为全局，在页面的任意位置都可以访问到
(3)在全局作用域中有全局对象window，代表一个浏览器窗囗，由浏览器创建，可以直接调用
(4)全局作用域中声明的变量和函数会作为window对象的属性和方法保存

2. 函数作用域
(1)调用函数时，函数作用域被创建，函数执行完毕，函数作用域被销毁
(2)每调用一次函数就会创建一个新的函数作用域，他们之间是相互独立的
(3)在函数作用域中可以访问到全局作用域的变量，在函数外无法访问到函数作用域内的变量
(4）在函数作用域中访问变量、函数时，会先在自身作用域中寻找，若没有找到，则会到函数的上一级作用域中寻找，一直到全局作用域
## 作用域的深层次理解

+ 执行期的上下文
  - 当函数代码执行的前期会创建一个执行期上下文的内部对象AO(作用域）
  - 这个内部的对象是预编译的时候创建出来的因为当函数被调用的时候会先进行预编译
  - 在全局代码执行的前期会创建一个执行期的上下文的对象GO
  
+ 这里有关js的预编译也简单的提一下

# 函数作用域预编译
1. 创建ao对象AO{}
2. 找形参和变量声明将变量和形参名当做A0对象的属名值为undefined
3. 实参形参相统一
4. 在函数体里面找函数声明值赋予函数体
# 全局作用域的预编译
1. 创建GO对象
2. 找变量声明将变量名作为GO对象的属性名值是undefined
3. 找函数声明值赋予函数体

[预编译阿里笔试题](1-预编译习题.md)

+ 作用域链
  - 一会被保存到一个隐式的属性中去[[scope]]这个属性是我们用户访问不到的但是的的确确是存在的让js引擎来访问的里面存储的就是作用域链AOGOAO和GO的集合

```js
function fn(){}
console.log(fn.name)
```

```js
var global
  function a() {
      function b() {
          var bb = 123
          aa = 0
      }
      var aa = 123
      b() //执行完所有函数后，删除所有作用域链，下次调用函数再接上
  }
      a()
      a()
```
[作用域](7-作用域.html)
![a定义](https://gitee.com/ye_xing_bear/pic-go/raw/master/%E4%B8%AA%E4%BA%BA%E5%9B%BE%E5%BA%8A/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-04-11%20145606.jpg)
![a执行](https://gitee.com/ye_xing_bear/pic-go/raw/master/%E4%B8%AA%E4%BA%BA%E5%9B%BE%E5%BA%8A/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-04-11%20150018.jpg)
![b定义](https://gitee.com/ye_xing_bear/pic-go/raw/master/%E4%B8%AA%E4%BA%BA%E5%9B%BE%E5%BA%8A/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-04-11%20150256.jpg)
![b执行](https://gitee.com/ye_xing_bear/pic-go/raw/master/%E4%B8%AA%E4%BA%BA%E5%9B%BE%E5%BA%8A/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-04-11%20150447.jpg)

```js
function a() {
  var aa = 123
  function b() {
      var bb = 234
      console.log(aa)
  } //可不可以输出123呢???
  return b
}
var res = a() 
res()/**函数a执行时，定义了b函数，此时b函数可以访问a函数的AO
      **函数a执行完成，断开函数a的作用域链，但是定义b函数的作用域链并没有断开
      所以执行b函数时，还可以访问a的AO**/
```
![闭包](https://gitee.com/ye_xing_bear/pic-go/raw/master/%E4%B8%AA%E4%BA%BA%E5%9B%BE%E5%BA%8A/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202021-04-11%20151655.jpg)
